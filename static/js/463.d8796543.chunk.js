"use strict";(self.webpackChunkBusiness_Management=self.webpackChunkBusiness_Management||[]).push([[463],{463:(e,s,t)=>{t.r(s),t.d(s,{default:()=>S});var n=t(9950),r=t(6220),l=t(4276),o=t(9786),a=t(6178),i=t(9751),d=t(1714),c=t(6275),h=t(4635),u=t(9154),p=t(6509),x=t(7065),j=t(4776),g=t(7725),f=t(9933),m=t(3618),b=t(4333),A=t(549),_=t(5022),y=t(8429),N=t(6974),w=t(6152),v=t(4414);const k={container:{maxWidth:"100%",margin:"0 auto",padding:"20px",backgroundColor:"var(--bg-color)",borderRadius:"8px"},uploadButton:{padding:"5px 20px",margin:"10px 0",backgroundColor:"#007bff",color:"#fff",border:"none",borderRadius:"5px",cursor:"pointer",fontSize:"16px"},deleteButton:{padding:"5px 10px",backgroundColor:"#dc3545",color:"#fff",border:"none",borderRadius:"5px",cursor:"pointer"},downloadButton:{padding:"5px 10px",backgroundColor:"#28a745",color:"#fff",border:"none",borderRadius:"5px",cursor:"pointer",marginLeft:"10px"}},S=()=>{const[,e]=(0,b.sq)(),[s,t]=(0,n.useState)(),[S,B]=(0,n.useState)(!1),[R,D]=(0,n.useState)(!1),[I,C]=(0,n.useState)([]),[E,L]=(0,n.useState)([]),M=(0,r.rJ)(l.db,o.A.Files),[{authentication:$}]=(0,b.sq)();(0,y.Zp)();(0,n.useEffect)((()=>{(0,g.qW)().then((e=>{t(e)})).catch((()=>{t([])}))}),[]);const{getRootProps:F,getInputProps:G}=(0,c.VB)({onDrop:e=>{L((s=>[...s,...e]))},multiple:!0}),z=async(e,s,t)=>{if(e)try{const n=(0,i.KR)(l.IG,a.A.Files(s)),r=(0,i.bp)(n,e);return r.on("state_changed",(e=>{const s=e.bytesTransferred/e.totalBytes*100,n=[...I];n[t]=s,C(n),console.log(n)}),(e=>{console.error(e)})),r}catch(n){console.error(n)}},O=(s,n)=>{e({type:A.QN.SHOW_ASKING_MODAL,payload:{show:!0,message:"deleteMessage",btnAction:()=>(async(s,n)=>{e({type:A.QN.SET_GLOBAL_LOADING,payload:{value:!0}}),e({type:A.QN.HIDE_ASKING_MODAL});try{const e=decodeURIComponent(n.split("/o/")[1].split("?")[0]),o=(0,i.KR)(l.IG,e);await(0,i.XR)(o);const a=(0,r.H9)(M,s);await(0,r.kd)(a),t((e=>e.filter((e=>e.id!==s)))),d.oR.success("File deleted successfully")}catch(o){console.error("Error deleting file:",o),d.oR.error("Error deleting file")}finally{e({type:A.QN.SET_GLOBAL_LOADING,payload:{value:!1}})}})(s,n)}})};return $.isAuthenticated?$.roles.includes(_.A.ADMIN)||$.roles.includes(_.A.SUPER_ADMIN)?(0,v.jsxs)("div",{style:k.container,children:[(0,v.jsx)("h2",{className:"title",children:(0,h.t)("files")}),(0,v.jsx)(u.A,{icon:R?p.A.cross:p.A.plus,text:R?(0,h.t)("cancel"):(0,h.t)("add"),onClick:()=>{D(!R),L([])},btnType:R?"crossBtn":"plusBtn"}),R&&(0,v.jsxs)("div",{className:"margin_top_10",children:[(0,v.jsxs)("section",{className:"file_drag_n_drop position_relative",children:[(0,v.jsxs)("div",{...F({className:"dropzone"}),children:[(0,v.jsx)("input",{...G()}),0==E.length&&(0,v.jsx)("p",{className:"cursor_pointer",children:(0,h.t)("dragFileToUpload")})]}),E.length>0&&(0,v.jsxs)("aside",{className:"position_absolute file_list",children:[(0,v.jsx)("h4",{children:(0,h.t)("files")}),(0,v.jsx)("ul",{children:E.map((e=>(0,v.jsxs)("li",{children:[e.path," - ",e.size," bytes"]},e.path)))})]})]}),(0,v.jsxs)("div",{children:[S&&(0,v.jsx)("div",{children:I.map(((e,s)=>(0,v.jsxs)("div",{children:[(0,v.jsxs)("span",{children:["File ",s+1," Progress: ",Math.round(e),"%"]}),(0,v.jsx)("progress",{value:e,max:"100"})]},s)))}),(0,v.jsx)("button",{onClick:async()=>{if(!E||0===E.length)return;B(!0);const e=[...E];for(let l=0;l<e.length;l++){const s=e[l],o=`${s.name}-[${(new Date).getMilliseconds()}]`;try{const n=await z(s,o,l),a=await(0,i.qk)(n.ref),d={name:s.name,size:s.size,url:a,date:new Date,descriptions:""},c=await(0,r.gS)(M,d),h=await(0,r.x7)(c);h.exists()?t((e=>[...e,(0,j.gQ)(h)])):console.error("No such document!");const u=[...e];u.splice(l,1),L(u)}catch(n){console.error("Error uploading file:",n)}}B(!1),D(!1);const s={createdDate:new Date,registrar:`${$.name} ${$.lastname}`,title:`${(0,h.t)("add")} ${(0,h.t)("files")}`,message:`[${E.length}] ${(0,h.t)("files")} ${(0,h.t)("successfullyAdded")}`,data:{...E}};await(0,g.ll)(s),d.oR.success("successfullyAdded")},disabled:!E||S||0==E.length,style:k.uploadButton,children:S?"Uploading...":"Upload Files"})]})]}),s?(0,v.jsx)("div",{className:"full_width overflow_x_scroll",children:(0,v.jsxs)("table",{className:"custom_table full_width margin_top_20",children:[(0,v.jsxs)("thead",{style:{backgroundColor:"orange"},children:[(0,v.jsx)("tr",{children:(0,v.jsx)("th",{colSpan:5,children:(0,h.t)("uploadedFiles")})}),(0,v.jsxs)("tr",{children:[(0,v.jsx)("th",{children:"#"}),(0,v.jsx)("th",{children:(0,h.t)("name")}),(0,v.jsx)("th",{children:(0,h.t)("size")}),(0,v.jsx)("th",{children:(0,h.t)("date")}),(0,v.jsx)("th",{children:(0,h.t)("actions")})]})]}),(0,v.jsxs)("tbody",{children:[s.map(((e,s)=>(0,v.jsxs)("tr",{children:[(0,v.jsx)("td",{children:s+1}),(0,v.jsx)("td",{children:(0,v.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",children:e.name})}),(0,v.jsxs)("td",{children:[(e.size/1024).toFixed(2)," KB"]}),(0,v.jsx)("td",{children:(0,x.qI)(e.date)}),(0,v.jsx)("td",{children:(0,v.jsx)("button",{onClick:()=>O(e.id,e.url),style:k.deleteButton,children:(0,h.t)("delete")})})]},e.id))),0===(null===s||void 0===s?void 0:s.length)&&(0,v.jsx)("tr",{children:(0,v.jsx)("td",{colSpan:5,children:(0,h.t)("notExist")})})]})]})}):(0,v.jsxs)(f.A,{children:[(0,v.jsx)(m.A,{}),(0,v.jsx)(m.A,{}),(0,v.jsx)(m.A,{}),(0,v.jsx)(m.A,{}),(0,v.jsx)(m.A,{}),(0,v.jsx)(m.A,{})]})]}):(0,v.jsx)(N.default,{}):(0,v.jsx)(w.A,{})}}}]);