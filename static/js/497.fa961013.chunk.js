"use strict";(self.webpackChunkBusiness_Management=self.webpackChunkBusiness_Management||[]).push([[497],{6497:(e,n,t)=>{t.r(n),t.d(n,{default:()=>w});var s=t(4635),i=t(9950),l=t(549),o=t(4333),a=t(2011),c=t(9154),d=t(4414);const r=function(){const[e,n]=(0,i.useState)(!1);return(0,d.jsx)("div",{children:(0,d.jsx)("section",{children:e?(0,d.jsx)(c.A,{text:(0,s.t)("cancel"),onClick:()=>n(!1)}):(0,d.jsx)(c.A,{text:(0,s.t)("change")+" "+(0,s.t)("password"),onClick:()=>n(!0)})})})};const u=function(){const[{locale:e},n]=(0,o.sq)();return(0,i.useEffect)((()=>{document.documentElement.dir="en"===e?"ltr":"rtl",document.documentElement.lang="en"===e?"en":"fa"}),[e]),(0,d.jsx)("div",{children:(0,d.jsxs)("section",{className:"",children:[(0,d.jsx)("p",{className:"title",children:(0,s.t)("change")+" "+(0,s.t)("language")}),(0,d.jsxs)("select",{className:" ",name:"languages",id:"",defaultValue:e,onChange:e=>{const t=e.target.value;console.log(t),n({type:l.QN.CHANGE_LOCALE,payload:{lang:t}})},children:[(0,d.jsx)("option",{value:"fa",children:"Farsi"}),(0,d.jsx)("option",{value:"en",children:"English"})]})]})})};var p=t(4993),m=t(9786),x=t(6220),f=t(4276),g=t(8728),h=t.n(g),v=t(8692),j=t(6509);const y=e=>{let{visibility:n=!1}=e;return(0,d.jsxs)("div",{className:"sm_ring",style:{visibility:n?"visible":"hidden"},children:[(0,d.jsx)("div",{}),(0,d.jsx)("div",{}),(0,d.jsx)("div",{}),(0,d.jsx)("div",{})]})};var b=t(7246);const k={container:{maxWidth:"100%",margin:"50px auto",padding:"20px",border:"1px solid #e1e1e1",borderRadius:"10px",backgroundColor:"#ffffff",boxShadow:"0 4px 8px rgba(0, 0, 0, 0.1)"},title:{marginBottom:"20px",fontSize:"18px",fontWeight:"bold",color:"#333"},icon:{fontSize:"40px",color:"#007bff",marginBottom:"10px"},inputContainer:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"20px"},fileInput:{display:"none"},customFileInput:{display:"inline-block",padding:"5px 20px",backgroundColor:"#007bff",color:"#fff",borderRadius:"5px",cursor:"pointer",transition:"background-color 0.3s"},customFileInputHover:{backgroundColor:"#0056b3"},loadingText:{display:"block",margin:"10px 0",fontSize:"16px",color:"#007bff",fontWeight:"bold"},button:{padding:"10px 20px",fontWeight:"bold"},alert:{marginTop:"20px"}},N=()=>{const[e,n]=(0,i.useState)({}),[t,l]=(0,i.useState)(""),[o,a]=(0,i.useState)(null),[r,u]=(0,i.useState)(!1),[p,g]=(0,i.useState)(""),[N,A]=(0,i.useState)(""),S=e=>e.split(".")[0],_=async(e,n)=>{const t=JSON.parse(n);for(const s of t){s.createdDate&&(s.createdDate=w(s.createdDate)),s.joinedDate&&(s.joinedDate=w(s.joinedDate)),s.date&&(s.date=w(s.date));const n=(0,x.H9)(f.db,e,s.id);await(0,x.BN)(n,s)}},w=e=>{if("string"===typeof e)return x.Dc.fromDate(new Date(e));if(e instanceof Object&&null!=e){if(e.seconds&&e.nanoseconds)return new x.Dc(e.seconds,e.nanoseconds)}else if(null!=e&&null!==e&&void 0!==e&&e.seconds)return new x.Dc(e.seconds,e.nanoseconds);return null};return(0,d.jsxs)("div",{style:k.container,children:[(0,d.jsx)("h1",{className:"title",children:(0,s.t)("backup")}),(0,d.jsxs)("div",{style:k.container,children:[(0,d.jsxs)("div",{className:"text-center display_flex align_items_center",children:[(0,d.jsx)("i",{style:k.icon,className:j.A.arrowDownShort}),(0,d.jsx)("h2",{style:k.title,children:(0,s.t)("saveBackup")})]}),(0,d.jsxs)("div",{className:"display_flex align_items_center  flex_flow_wrap justify_content_space_between   margin_right_10 margin_left_10",children:[(0,d.jsx)("ul",{className:"list",children:Object.keys(m.A).map((n=>(0,d.jsxs)("li",{className:"display_flex margin_5",style:{marginBottom:"10px"},children:["loading"==e[n]&&(0,d.jsx)(y,{visibility:!0}),"done"==e[n]&&(0,d.jsx)("i",{className:j.A.thick,style:{color:"var(--main-color)",fontSize:"20px",margin:"0 5px"}}),(0,d.jsx)("span",{children:(0,s.t)(m.A[n].toLowerCase())})]},n)))}),(0,d.jsx)("div",{className:"align_self_end",children:(0,d.jsx)(c.A,{text:(0,s.t)("backupAll"),onClick:async()=>{const e={...m.A};Object.keys(m.A).forEach((n=>{e[n]="loading"})),n(e);const t=new(h()),s=Object.keys(m.A).map((async s=>{try{const e=await(async e=>{const n=(await(0,x.GG)((0,x.rJ)(f.db,e))).docs.map((n=>(console.log(e+" : "+n.id),{...n.data(),id:n.id})));return JSON.stringify(n,null,2)})(m.A[s]);t.file(`${m.A[s]}.json`,e)}catch(i){console.error(`Failed to backup collection ${m.A[s]}`,i)}finally{e[s]="done",n({...e})}}));await Promise.all(s),t.generateAsync({type:"blob"}).then((e=>{const n=URL.createObjectURL(e),t=document.createElement("a");t.href=n,t.download=`backup-[${(0,v.dT)(new Date).join("/")}].zip`,document.body.appendChild(t),t.click(),URL.revokeObjectURL(n),t.remove()}))},icon:j.A.download,btnType:b.A.modern})})]})]}),(0,d.jsxs)("div",{style:k.container,children:[(0,d.jsxs)("div",{className:"text-center display_flex align_items_center",children:[(0,d.jsx)("i",{style:k.icon,className:j.A.arrowUpShort}),(0,d.jsx)("h2",{style:k.title,children:(0,s.t)("upload")})]}),(0,d.jsxs)("div",{style:k.inputContainer,children:[(0,d.jsx)("input",{type:"file",accept:".zip",onChange:e=>{var n;const t=(null===(n=e.target.files)||void 0===n?void 0:n[0])||null;t?(a(t),g(`${(0,s.t)("selectedFile")}: ${t.name}`),A("")):(g(""),A("No file selected."))},style:k.fileInput,id:"fileInput"}),(0,d.jsx)("label",{htmlFor:"fileInput",style:k.customFileInput,children:(0,s.t)("addFile")}),(0,d.jsx)(c.A,{onClick:async()=>{if(!o)return void A((0,s.t)("fileUploadAlert"));u(!0),g(""),A("");const e=new(h());try{const n=await e.loadAsync(o);let t=Object.keys(n.files).length,i=1;for(const e of Object.keys(n.files)){const s=i++/t*100;l(`${s.toFixed(0)}%`);const o=await n.files[e].async("string"),a=S(e);console.log(a+" <================================"),await _(a,o)}a(null),g((0,s.t)("uploadedSuccessfully"))}catch(n){console.error("Error importing data from ZIP file:",n)}finally{u(!1)}},disabled:r,isLock:r,text:r?(0,s.t)("uploadingData"):(0,s.t)("upload")})]}),r&&(0,d.jsxs)("span",{style:k.loadingText,children:[t," ",(0,s.t)("uploadingData")]}),p&&(0,d.jsx)("p",{style:k.alert,children:p}),N&&(0,d.jsx)("p",{style:{...k.alert,color:"red"},children:N})]})]})};var A=t(6974),S=t(5022);const _={accountSettings:{componentName:"AccountSettings",component:r},backup:{componentName:"backup",component:N},systemSettings:{componentName:"SystemSettings",component:u}};const w=function(){var e,n,t;const[{authentication:i},l]=(0,o.sq)(),[c,r]=(0,p.A)(_,"accountSettings");return console.log(i),i.roles.includes(S.A.ADMIN)||i.roles.includes(S.A.SUPER_ADMIN)?(0,d.jsxs)("div",{className:"settings ",id:"settings",children:[(0,d.jsxs)(a.A,{children:[(0,d.jsx)("li",{className:(null===c||void 0===c?void 0:c.componentName)==(null===_||void 0===_||null===(e=_.accountSettings)||void 0===e?void 0:e.componentName)?"active":"",onClick:()=>r(null===_||void 0===_?void 0:_.accountSettings),children:(0,s.t)("accountSettings")}),(0,d.jsx)("li",{className:(null===c||void 0===c?void 0:c.componentName)==(null===_||void 0===_||null===(n=_.backup)||void 0===n?void 0:n.componentName)?"active":"",onClick:()=>r(null===_||void 0===_?void 0:_.backup),children:(0,s.t)("backup")}),(0,d.jsx)("li",{className:(null===c||void 0===c?void 0:c.componentName)==(null===_||void 0===_||null===(t=_.systemSettings)||void 0===t?void 0:t.componentName)?"active":"",onClick:()=>r(null===_||void 0===_?void 0:_.systemSettings),children:(0,s.t)("systemSettings")})]}),(0,d.jsx)(c.component,{})]}):(0,d.jsx)(A.default,{})}}}]);