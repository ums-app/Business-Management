"use strict";(self.webpackChunkBusiness_Management=self.webpackChunkBusiness_Management||[]).push([[167],{2167:(e,t,s)=>{s.r(t),s.d(t,{default:()=>R});var n=s(9950),l=s(4635),a=s(6220),o=s(9786),i=s(8429),c=s(8484),r=s(9933),d=s(5214),m=s(329),h=s(7322),u=s(9154),x=s(1823),p=s(1683),j=s(4276),v=s(7725),f=s(4776),_=s(7246),N=s(6657),g=s(4414);const y=()=>{const e=(0,i.Zp)(),t=(0,a.rJ)(j.db,o.A.Customers),s=(0,a.rJ)(j.db,o.A.Employees),[y,S]=(0,n.useState)(c.mm[0]),[A,b]=(0,n.useState)(),[C,w]=(0,n.useState)(0),[P,L]=(0,n.useState)(1),[M,T]=(0,n.useState)([]),[E,G]=(0,n.useState)(null),[D,O]=(0,n.useState)(null),[k,B]=(0,n.useState)(!1),[I,z]=(0,n.useState)(""),[F,q]=(0,n.useState)(!1),[R,J]=(0,n.useState)(),[X,U]=(0,n.useState)(),[H,Q]=(0,n.useState)(""),[V,Z]=(0,n.useState)([]);(0,n.useEffect)((()=>{ee(),K(c.mm[0])}),[]),(0,n.useEffect)((()=>{M&&(async()=>{const e={};await Promise.all(M.map((async t=>{try{const s=await(0,v.ff)(t.email);e[t.email]=s}catch(s){}}))),U(e)})()}),[M]),(0,n.useEffect)((()=>{const e=Y($,300);return()=>{e.cancel()}}),[H]);const Y=(e,t)=>{let s;const n=function(){for(var n=arguments.length,l=new Array(n),a=0;a<n;a++)l[a]=arguments[a];s&&clearTimeout(s),s=setTimeout((()=>{e(...l)}),t)};return n.cancel=()=>{s&&clearTimeout(s)},n},$=async e=>{const t=e.target.value;if(z(t),Q(t),0===t.trim().length)return W(c.mm[0]),void Z([]);console.log(t);const s=(0,a.P)((0,a.rJ)(j.db,o.A.Customers),(0,a._M)("name",">=",t),(0,a._M)("name","<=",t+"\uf8ff")),n=await(0,a.GG)(s),l=[];n.forEach((e=>{const t=e.data();console.log(t),l.push({name:t.name,lastName:t.lastName,id:e.id})})),console.log(l),Z(l)},K=async e=>{const s=(await(0,a.d_)(t)).data().count;w(s);const n=Math.ceil(s/e);b(n),W(e)},W=async e=>{q(!0);const s=(0,a.P)(t,(0,a.My)("name"),(0,a.AB)(e)),n=await(0,a.GG)(s),l=n.docs.map((e=>(0,f.c1)(e)));T(l),O(n.docs[0]),G(n.docs[n.docs.length-1]),B(!1),L(1),q(!1)},ee=async()=>{const e=(await(0,a.GG)(s)).docs.map((e=>(0,f.S6)(e)));J(e)};return M&&R&&X?(0,g.jsxs)("div",{children:[(0,g.jsx)(u.A,{text:(0,l.t)("add")+" "+(0,l.t)("customer"),onClick:()=>e("add"),btnType:_.A.modern}),(0,g.jsx)("h1",{className:"margin_10 title",children:(0,l.t)("customers")}),(0,g.jsxs)("div",{className:"search_pagination display_flex flex_flow_wrap justify_content_space_between input align_items_center",children:[(0,g.jsxs)("div",{className:"search_bar",children:[(0,g.jsxs)("div",{className:"position_relative full_width",children:[(0,g.jsx)("input",{type:"text",placeholder:(0,l.t)("search"),value:H,onChange:$,id:"searchBoxSelect",className:"full_width",autoComplete:"off"}),V.length>0&&(0,g.jsx)("ul",{className:"suggestion_box",children:V.map(((e,t)=>(0,g.jsxs)("li",{className:"cursor_pointer",onClick:()=>(async(e,t)=>{q(!0),Q(e+" "+t);const s=(0,a.P)((0,a.rJ)(j.db,o.A.Customers),(0,a._M)("name","==",e),(0,a._M)("lastName","==",t));try{const e=(await(0,a.GG)(s)).docs.map((e=>(0,f.c1)(e)));T(e),Z([])}catch(n){console.log(n)}finally{q(!1)}})(e.name,e.lastName),children:[e.name," ",e.lastName]},t)))})]}),(0,g.jsx)(x.m_,{anchorSelect:"#searchBoxSelect",place:"top",className:"toolTip_style",children:(0,l.t)("enterValueForSearching")})]}),(0,g.jsxs)("div",{className:"pagination display_flex ",children:[(0,g.jsxs)("div",{className:"display_flex align_items_center ",children:[(0,g.jsx)("label",{htmlFor:"pageSize",children:(0,l.t)("size")}),(0,g.jsx)("select",{name:"pageSize",id:"pageSize",className:"input margin_left_10 margin_right_10",onChange:e=>{S(Number(e.target.value)),K(Number(e.target.value))},children:c.mm.map((e=>(0,g.jsx)("option",{value:e,children:e},e)))}),(0,g.jsx)(x.m_,{anchorSelect:"#pageSize",place:"top",className:"toolTip_style",children:(0,l.t)("numberOfElementPerPage")})]}),(0,g.jsx)(p.A,{total:A,currentPage:P,nextPage:async()=>{if(!E)return;q(!0);const e=(0,a.P)(t,(0,a.My)("name"),(0,a.HM)(E),(0,a.AB)(y)),s=await(0,a.GG)(e);if(!s.empty){const e=s.docs.map((e=>(0,f.c1)(e)));T(e),O(s.docs[0]),G(s.docs[s.docs.length-1]),B(!0),L((e=>e+1))}q(!1)},prevPage:async()=>{if(!D)return;q(!0);const e=(0,a.P)(t,(0,a.My)("name"),(0,a.rf)(D),(0,a.$1)(y)),s=await(0,a.GG)(e);if(!s.empty){const e=s.docs.map((e=>(0,f.c1)(e)));T(e),O(s.docs[0]),G(s.docs[s.docs.length-1]),B(s.docs.length===y),L((e=>e-1))}q(!1)},isPrevPageAvailable:k})]})]}),(0,g.jsx)("div",{className:"table_container ",children:F?(0,g.jsx)(h.A,{}):(0,g.jsxs)("table",{className:"full_width custom_table table_row_hover overflow_hidden",children:[(0,g.jsx)("thead",{children:(0,g.jsxs)("tr",{children:[(0,g.jsx)("th",{children:(0,l.t)("number")}),(0,g.jsx)("th",{children:(0,l.t)("image")}),(0,g.jsx)("th",{children:(0,l.t)("name")}),(0,g.jsx)("th",{children:(0,l.t)("lastName")}),(0,g.jsx)("th",{children:(0,l.t)("location")}),(0,g.jsx)("th",{children:(0,l.t)("phoneNumber")}),(0,g.jsx)("th",{children:(0,l.t)("visitor")})]})}),(0,g.jsxs)("tbody",{children:[null===M||void 0===M?void 0:M.map(((t,s)=>{const n=R.find((e=>e.id==t.visitor));return(0,g.jsxs)("tr",{className:" cursor_pointer hover",onClick:()=>e("/customers/"+t.id),children:[(0,g.jsx)("td",{children:s+1}),(0,g.jsx)("td",{children:(0,g.jsx)(N.A,{imgURL:X[t.email],height:"60px",width:"60px",alt:(0,l.t)("user")+" "+(0,l.t)("image")})}),(0,g.jsx)("td",{children:t.name}),(0,g.jsx)("td",{children:t.lastName}),(0,g.jsx)("td",{children:t.location}),(0,g.jsx)("td",{children:t.phoneNumber}),(0,g.jsxs)("td",{children:[null===n||void 0===n?void 0:n.name," ",null===n||void 0===n?void 0:n.lastName]})]},t.id)})),0==(null===M||void 0===M?void 0:M.length)&&(0,g.jsx)("tr",{children:(0,g.jsx)("td",{colSpan:7,children:(0,l.t)("notExist")})})]})]})})]}):(0,g.jsxs)(r.A,{children:[(0,g.jsx)(d.A,{}),(0,g.jsx)(m.A,{}),(0,g.jsx)(h.A,{})]})};var S=s(7065),A=s(8692),b=s(549),C=s(3367),w=s(4333),P=s(5418),L=s.n(P),M=s(6509),T=s(9450);const E="all",G="debtorCustomers",D="creditorCustomers",O="settled",k=()=>{const[,e]=(0,w.sq)(),[t,s]=(0,n.useState)(),[a,o]=(0,n.useState)([]),[i,c]=(0,n.useState)([]),[d,m]=(0,n.useState)([]),[x,p]=(0,n.useState)(!1);let j=null;const[f,_]=(0,n.useState)();(0,n.useEffect)((()=>{(0,v.od)().then((e=>{s(e)})),(0,v.Vg)().then((e=>{o(e)})),(0,v.Gl)().then((e=>{c(e)}))}),[]),(0,n.useEffect)((()=>{t&&a&&i&&(console.log("short list added"),N(E))}),[t,a,i]);const N=e=>{p(!0);const s=[];null===t||void 0===t||t.map((t=>{var n,l,o,c,r,d;const m=a.filter((e=>e.customerId==t.id)),h=i.filter((e=>(null===e||void 0===e?void 0:e.customer.id)==t.id)),u=(0,v.Oo)(m),x=(0,v.fX)(h)-u,p={name:t.name,lastName:t.lastName,customerLocation:t.location,customerPhoneNumber:t.phoneNumber,lastPurchaseDate:null!==(n=h[0])&&void 0!==n&&n.createdDate?(0,S.qI)(null===(l=h[0])||void 0===l?void 0:l.createdDate):"",lastPurchaseAmount:(0,v.fX)([h[0]]),lastPaymentDate:null!==(o=m[0])&&void 0!==o&&o.createdDate?(0,S.qI)(null===(c=m[0])||void 0===c?void 0:c.createdDate):"",lastPaymentAmount:(null===(r=m[0])||void 0===r?void 0:r.amount)&&(null===(d=m[0])||void 0===d?void 0:d.amount),remainedAmount:x};console.log(t,p),e==G&&x>0?(console.log("if ",e+" == "+G),s.push(p)):e==D&&x<0?(console.log("if ",e+" == "+D),s.push(p)):e==O&&0==x?(console.log("if ",e+" == "+O),s.push(p)):e==E&&(console.log("if all"),s.push(p))})),console.log(s),m(s),p(!1)};return t&&a&&i?(0,g.jsxs)("div",{children:[(0,g.jsxs)("div",{className:"display_flex flex_flow_wrap justify_content_space_between",children:[(0,g.jsx)(L(),{content:()=>j,trigger:()=>(0,g.jsx)(u.A,{text:(0,l.t)("print"),icon:M.A.printer}),copyStyles:!0,onBeforePrint:()=>{e({type:b.QN.SET_GLOBAL_LOADING,payload:{value:!0}})},onAfterPrint:()=>{e({type:b.QN.SET_GLOBAL_LOADING,payload:{value:!1}})},pageStyle:(0,C.A)({pageSize:"A4",orientation:"landscape"}),documentTitle:(0,l.t)("customerListTitleForShortList")}),(0,g.jsxs)("div",{className:"display_flex flex_flow_wrap width_max_content align_items_center",children:[(0,g.jsxs)("label",{htmlFor:"filters",className:"word_break_no",children:[(0,l.t)("listBy"),": "]}),(0,g.jsxs)("select",{name:"filters",id:"",onChange:e=>{_(e.target.value),N(e.target.value)},children:[(0,g.jsx)("option",{value:E,children:(0,l.t)(E)}),(0,g.jsx)("option",{value:G,children:(0,l.t)(G)}),(0,g.jsx)("option",{value:D,children:(0,l.t)(D)}),(0,g.jsx)("option",{value:O,children:(0,l.t)(O)})]})]})]}),(0,g.jsxs)("div",{ref:e=>j=e,className:"customers_list overflow_x_scroll",children:[(0,g.jsxs)("div",{className:"full_width display_flex flex_direction_column align_items_center",children:[(0,g.jsx)("p",{className:"title",children:(0,l.t)("customerListTitleForShortList")}),(0,g.jsxs)("div",{className:"bold full_width display_flex justify_content_end",children:[(0,g.jsxs)("span",{children:[(0,l.t)("date"),":"]}),(0,g.jsx)("span",{className:"info_value",children:(0,A.dT)(new Date).join("/")})]})]}),x?(0,g.jsx)(h.A,{}):(0,g.jsxs)("table",{className:"custom_table full_width",children:[(0,g.jsxs)("thead",{children:[(0,g.jsxs)("tr",{style:{backgroundColor:"#f744e2"},children:[(0,g.jsx)("th",{rowSpan:2,children:(0,l.t)("number")}),(0,g.jsx)("th",{colSpan:2,children:(0,l.t)("specification")}),(0,g.jsx)("th",{rowSpan:2,children:(0,l.t)("location")}),(0,g.jsx)("th",{colSpan:2,children:(0,l.t)("lastPurchaseFactor")}),(0,g.jsx)("th",{rowSpan:2,children:(0,l.t)("phoneNumber")}),(0,g.jsx)("th",{colSpan:2,children:(0,l.t)("lastPayment")}),(0,g.jsx)("th",{rowSpan:2,children:(0,l.t)("remainedAmount")}),(0,g.jsxs)("th",{rowSpan:2,children:[" ",(0,l.t)("currentAmount")]})]}),(0,g.jsxs)("tr",{style:{backgroundColor:"#f744e2"},children:[(0,g.jsx)("th",{children:(0,l.t)("name")}),(0,g.jsx)("th",{children:(0,l.t)("lastName")}),(0,g.jsx)("th",{children:(0,l.t)("amount")}),(0,g.jsx)("th",{children:(0,l.t)("date")}),(0,g.jsx)("th",{children:(0,l.t)("amount")}),(0,g.jsx)("th",{children:(0,l.t)("date")})]})]}),(0,g.jsxs)("tbody",{children:[d.map(((e,t)=>(0,g.jsxs)("tr",{style:{height:"30px"},children:[(0,g.jsx)("td",{children:t+1}),(0,g.jsx)("td",{children:e.name}),(0,g.jsx)("td",{children:e.lastName}),(0,g.jsx)("td",{children:e.customerLocation}),(0,g.jsx)("td",{children:e.lastPurchaseAmount}),(0,g.jsx)("td",{children:e.lastPurchaseDate}),(0,g.jsx)("td",{children:e.customerPhoneNumber}),(0,g.jsx)("td",{children:null===e||void 0===e?void 0:e.lastPaymentAmount}),(0,g.jsx)("td",{children:null===e||void 0===e?void 0:e.lastPaymentDate}),(0,g.jsxs)("td",{children:[Math.abs(e.remainedAmount),(0,g.jsx)("span",{style:{float:"left"},children:(0,g.jsx)(T.A,{number:e.remainedAmount})})]}),(0,g.jsx)("td",{})]},t))),0==d.length&&(0,g.jsx)("tr",{children:(0,g.jsx)("td",{colSpan:11,children:(0,l.t)("notExist")})})]})]})]})]}):(0,g.jsx)(r.A,{children:(0,g.jsx)(h.A,{})})};var B=s(2011),I=s(5022),z=s(6974),F=s(6152);const q={CustomersManagment:{componentName:"CustomersManagement",component:y},ShortListedCustomers:{componentName:"ShortListedCustomers",component:k},CustomerListOnCustomerType:{componentName:"CustomerListOnCustomerType",component:()=>{const[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)(!0),[o,r]=(0,n.useState)(),[d,m]=(0,n.useState)([]),u=(0,i.Zp)();return(0,n.useEffect)((()=>{(0,v.qp)([c.DX.OTHER_CITY,c.DX.DISTRICT]).then((e=>t(e))).finally((()=>a(!1))),(0,v.Oc)().then((e=>m(e)))}),[]),(0,n.useEffect)((()=>{e&&(async()=>{const t={};await Promise.all(e.map((async e=>{try{const s=await(0,v.ff)(e.email);t[e.email]=s}catch(s){}}))),r(t)})()}),[e]),(0,g.jsx)("div",{children:(0,g.jsx)("div",{className:"table_container ",children:s?(0,g.jsx)(h.A,{}):(0,g.jsxs)("table",{className:"full_width custom_table table_row_hover overflow_hidden",children:[(0,g.jsx)("thead",{children:(0,g.jsxs)("tr",{children:[(0,g.jsx)("th",{children:"#"}),(0,g.jsx)("th",{children:(0,l.t)("image")}),(0,g.jsx)("th",{children:(0,l.t)("name")}),(0,g.jsx)("th",{children:(0,l.t)("lastName")}),(0,g.jsx)("th",{children:(0,l.t)("location")}),(0,g.jsx)("th",{children:(0,l.t)("phoneNumber")}),(0,g.jsx)("th",{children:(0,l.t)("visitor")})]})}),(0,g.jsxs)("tbody",{children:[null===e||void 0===e?void 0:e.map(((e,t)=>{const s=d.find((t=>t.id==e.visitor));return(0,g.jsxs)("tr",{className:" cursor_pointer hover",onClick:()=>u("/customers/"+e.id),children:[(0,g.jsx)("td",{children:t+1}),(0,g.jsx)("td",{children:(0,g.jsx)(N.A,{imgURL:o[e.email],height:"60px",width:"60px",alt:(0,l.t)("user")+" "+(0,l.t)("image")})}),(0,g.jsx)("td",{children:e.name}),(0,g.jsx)("td",{children:e.lastName}),(0,g.jsx)("td",{children:e.location}),(0,g.jsx)("td",{children:e.phoneNumber}),(0,g.jsxs)("td",{children:[null===s||void 0===s?void 0:s.name," ",null===s||void 0===s?void 0:s.lastName]})]},e.id)})),0==(null===e||void 0===e?void 0:e.length)&&(0,g.jsx)("tr",{children:(0,g.jsx)("td",{colSpan:7,children:(0,l.t)("notExist")})})]})]})})})}}};const R=function(){var e,t,s;const[a,o]=(0,n.useState)({component:q.CustomersManagment.component,componentName:"CustomersManagement"}),[{authentication:i}]=(0,w.sq)();return i.isAuthenticated?i.roles.includes(I.A.ADMIN)||i.roles.includes(I.A.SUPER_ADMIN)?(0,g.jsxs)("div",{className:"employee",children:[(0,g.jsxs)(B.A,{children:[(0,g.jsx)("li",{className:(null===a||void 0===a?void 0:a.componentName)==(null===q||void 0===q||null===(e=q.CustomersManagment)||void 0===e?void 0:e.componentName)?"active":"",onClick:()=>o({component:null===q||void 0===q?void 0:q.CustomersManagment.component,componentName:q.CustomersManagment.componentName}),children:(0,l.t)("customersManagement")}),(0,g.jsx)("li",{className:(null===a||void 0===a?void 0:a.componentName)==(null===q||void 0===q||null===(t=q.ShortListedCustomers)||void 0===t?void 0:t.componentName)?"active":"",onClick:()=>o({component:null===q||void 0===q?void 0:q.ShortListedCustomers.component,componentName:q.ShortListedCustomers.componentName}),children:(0,l.t)("shortListedCustomers")}),(0,g.jsx)("li",{className:(null===a||void 0===a?void 0:a.componentName)==(null===q||void 0===q||null===(s=q.CustomerListOnCustomerType)||void 0===s?void 0:s.componentName)?"active":"",onClick:()=>o({component:null===q||void 0===q?void 0:q.CustomerListOnCustomerType.component,componentName:q.CustomerListOnCustomerType.componentName}),children:(0,l.t)("customerOfOtherCities")})]}),(0,g.jsx)("div",{children:(0,g.jsx)(a.component,{})})]}):(0,g.jsx)(z.default,{}):(0,g.jsx)(F.A,{})}}}]);